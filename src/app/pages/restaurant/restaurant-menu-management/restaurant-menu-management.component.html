<app-header-restaurant></app-header-restaurant>

<div class="order-list">
  <h1>Liste des Commandes</h1>
  <div class="order-grid">
    <div class="order-card" *ngFor="let order of orders">
      <div class="order-image">
        <!-- Image dynamique : on affiche l'image du 1er item si dispo, sinon image fallback -->
        <img [src]="getOrderImage(order)" alt="Image commande" onerror="this.src='assets/images/fallback.png'" />

        <div class="order-actions">
          <button class="accept-button"
                  [disabled]="order.status !== 'en_attente'"
                  (click)="acceptOrder(order)">
            Accepter
          </button>

          <button class="deliver-button"
                  *ngIf="order.status === 'en_cours'"
                  (click)="deliverOrder(order)">
            Livrer
          </button>

          <p class="status">
            <strong>Statut:</strong>
            <span [ngClass]="{
              'en-attente': order.status === 'en_attente',
              'en-cours': order.status === 'en_cours',
              'livre': order.status === 'livre'
            }">
              {{ order.status?.replace('_', ' ') }}
            </span>
          </p>
        </div>
      </div>

     <div class="order-details">
  <p><strong>Client:</strong> {{ order.customerName }}</p>
  <p><strong>Adresse:</strong> {{ order.address }}</p>
  <p><strong>Contact:</strong> {{ order.contact }}</p>

  <p><strong>Restaurant:</strong> {{ order.restaurantName }}</p>
<p><strong>Téléphone:</strong> {{ order.restaurantPhone }}</p>
<p><strong>Adresse:</strong> {{ order.restaurantAddress }}</p>


  <p><strong>Articles:</strong></p>
  <ul>
    <li *ngFor="let item of order.items">
      {{ item.name }} - {{ item.quantity }}
    </li>
  </ul>
</div>

    </div>
  </div>
</div>

<!-- ✅ Modal de succès après livraison -->
<div class="modal-backdrop" *ngIf="showSuccessModal">
  <div class="modal-content">
    <h2>Succès !</h2>
    <p>La commande #{{ currentOrderId }} est prête et envoyée aux livreurs.</p>
    <button (click)="closeSuccessModal()">Fermer</button>
  </div>
</div>

<app-footer></app-footer>
