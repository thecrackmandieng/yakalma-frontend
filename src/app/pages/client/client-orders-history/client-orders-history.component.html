<div class="container mx-auto p-4">
  <h1 class="text-2xl font-bold mb-4">Historique des Commandes</h1>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    <div *ngFor="let order of orders" class="bg-white shadow-md rounded-lg p-4 cursor-pointer hover:shadow-lg transition-shadow" (click)="openOrderDetails(order)">
      <img [src]="getOrderImage(order)" alt="Commande" class="w-full h-32 object-cover rounded mb-2">
      <h3 class="font-semibold">{{ order.restaurantName }}</h3>
      <p class="text-sm text-gray-600">{{ order.address }}</p>
      <p class="text-sm text-gray-600">{{ order.contact }}</p>
      <p class="text-sm font-medium">Total: {{ order.total }} FCFA</p>
      <span class="inline-block px-2 py-1 text-xs rounded" [ngClass]="{
        'bg-yellow-200 text-yellow-800': order.status === 'en_attente',
        'bg-blue-200 text-blue-800': order.status === 'en_cours',
        'bg-green-200 text-green-800': order.status === 'livre'
      }">
        {{ order.status === 'en_attente' ? 'En attente' : order.status === 'en_cours' ? 'En cours' : 'Livrée' }}
      </span>
    </div>
  </div>

  <!-- Modal Détails Commande -->
  <div *ngIf="selectedOrder" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" (click)="closeOrderDetails()">
    <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4" (click)="$event.stopPropagation()">
      <h2 class="text-xl font-bold mb-4">Détails de la Commande</h2>
      <img [src]="getOrderImage(selectedOrder)" alt="Commande" class="w-full h-32 object-cover rounded mb-4">
      <p><strong>Restaurant:</strong> {{ selectedOrder.restaurantName }}</p>
      <p><strong>Adresse:</strong> {{ selectedOrder.address }}</p>
      <p><strong>Contact:</strong> {{ selectedOrder.contact }}</p>
      <p><strong>Total:</strong> {{ selectedOrder.total }} FCFA</p>
      <p><strong>Statut:</strong> {{ selectedOrder.status === 'en_attente' ? 'En attente' : selectedOrder.status === 'en_cours' ? 'En cours' : 'Livrée' }}</p>
      <div *ngIf="selectedOrder.validationCode" class="mt-4 p-2 bg-gray-100 rounded">
        <p><strong>Code de Validation:</strong> {{ selectedOrder.validationCode }}</p>
        <p class="text-sm text-gray-600">Donnez ce code au livreur pour valider la livraison.</p>
      </div>
      <button class="mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600" (click)="closeOrderDetails()">Fermer</button>
    </div>
  </div>
</div>
